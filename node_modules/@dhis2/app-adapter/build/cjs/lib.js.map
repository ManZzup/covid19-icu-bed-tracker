{"version":3,"file":"lib.js","sources":["../../src/FatalErrorBoundary/styles/FatalErrorBoundary.style.js","../../src/FatalErrorBoundary/index.js","../../src/locales/index.js","../../src/AuthBoundary/LoginModal.js","../../src/AuthBoundary/useLocale.js","../../src/AuthBoundary/index.js","../../src/styles.js","../../src/index.js"],"sourcesContent":["import css from 'styled-jsx/css'\n\nconst bgColor = '#F4F6F8',\n    iconColor = '#B0BEC5',\n    primaryTextColor = '#000000',\n    secondaryTextColor = '#494949',\n    errorColor = 'red'\n\nexport default css`\n    .mask {\n        position: absolute;\n        top: 0px;\n        left: 0px;\n        right: 0px;\n        bottom: 0px;\n\n        overflow: auto;\n        overflow-y: auto;\n\n        color: ${primaryTextColor};\n        background-color: ${bgColor};\n\n        display: flex;\n\n        min-width: 640px;\n        min-height: 480px;\n\n        align-items: center;\n        justify-content: center;\n    }\n\n    .container {\n        text-align: center;\n        color: black;\n    }\n\n    .icon {\n        width: 96px;\n        height: 96px;\n        color: ${iconColor};\n        margin-bottom: 24px;\n    }\n\n    .message {\n        font-size: 24px;\n        margin-bottom: 24px;\n    }\n\n    .link {\n        font-size: 18px;\n        text-decoration: underline;\n        cursor: pointer;\n        margin-bottom: 24px;\n    }\n\n    .drawerToggle {\n        font-size: 12px;\n        color: ${secondaryTextColor};\n        text-decoration: underline;\n        cursor: pointer;\n        margin-bottom: 12px;\n    }\n\n    .drawerVisible {\n        padding: 8px;\n        display: block;\n        height: 150px;\n        width: 500px;\n        overflow: auto;\n        overflow-y: auto;\n        border: 1px solid ${secondaryTextColor};\n        text-align: left;\n    }\n\n    .drawerHidden {\n        display: none;\n    }\n\n    .errorIntro {\n        font-size: 12px;\n        line-height: 1.2;\n        color: ${secondaryTextColor};\n        margin-bottom: 8px;\n        font-family: Menlo, Courier, monospace !important;\n    }\n\n    .errorDetails {\n        font-size: 12px;\n        line-height: 1.2;\n        color: ${errorColor};\n        font-family: Menlo, Courier, monospace !important;\n    }\n`\n","import React, { Component } from 'react'\nimport PropTypes from 'prop-types'\nimport i18n from '@dhis2/d2-i18n'\nimport styles from './styles/FatalErrorBoundary.style'\n\nconst translatedErrorHeading = i18n.t(\n    'An error occurred in the DHIS2 application.'\n)\n\nconst replaceNewlinesWithBreaks = text =>\n    text\n        .split('\\n')\n        .reduce((out, line, i) => [...out, line, <br key={i} />], [])\n\nexport class FatalErrorBoundary extends Component {\n    constructor(props) {\n        super(props)\n        this.state = {\n            error: null,\n            errorInfo: null,\n            drawerOpen: false,\n        }\n    }\n\n    componentDidCatch(error, errorInfo) {\n        this.setState({\n            error,\n            errorInfo,\n        })\n    }\n\n    toggleTechInfoDrawer = () => {\n        this.setState({\n            drawerOpen: !this.state.drawerOpen,\n        })\n    }\n\n    render() {\n        const { children } = this.props\n        if (this.state.error) {\n            return (\n                <div className=\"mask\">\n                    <style jsx>{styles}</style>\n                    <div className=\"container\">\n                        {/* <InfoIcon className=\"icon\" /> */}\n                        <div className=\"message\">\n                            {i18n.t('Something went wrong')}\n                        </div>\n                        <div\n                            className=\"link\"\n                            onClick={() => window.location.reload()}\n                        >\n                            {i18n.t('Refresh to try again')}\n                        </div>\n                        <div\n                            className=\"drawerToggle\"\n                            onClick={this.toggleTechInfoDrawer}\n                        >\n                            {this.state.drawerOpen\n                                ? i18n.t('Hide technical details')\n                                : i18n.t('Show technical details')}\n                        </div>\n                        <div\n                            className={\n                                this.state.drawerOpen\n                                    ? 'drawerVisible'\n                                    : 'drawerHidden'\n                            }\n                        >\n                            <div className=\"errorIntro\">\n                                {translatedErrorHeading}\n                                <br />\n                                {i18n.t(\n                                    'The following information may be requested by technical support.'\n                                )}\n                            </div>\n                            <div className=\"errorDetails\">\n                                {[\n                                    replaceNewlinesWithBreaks(\n                                        this.state.error.stack +\n                                            '\\n---' +\n                                            this.state.errorInfo.componentStack\n                                    ),\n                                ]}\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            )\n        }\n\n        return children\n    }\n}\n\nFatalErrorBoundary.propTypes = {\n    children: PropTypes.node.isRequired,\n}\n","//------------------------------------------------------------------------------\n// <auto-generated>\n  // This code was generated by d2-i18n-generate.\n  //\n  // Changes to this file may cause incorrect behavior and will be lost if\n  // the code is regenerated.\n  // </auto-generated>\n//------------------------------------------------------------------------------\nimport i18n from '@dhis2/d2-i18n';\n\nimport enTranslations from './en/translations.json';\nimport esTranslations from './es/translations.json';\nimport frTranslations from './fr/translations.json';\n\nconst namespace = 'default';\ni18n.addResources('en', namespace, enTranslations);\ni18n.addResources('es', namespace, esTranslations);\ni18n.addResources('fr', namespace, frTranslations);\n\nexport default i18n;\n","import React, { useState } from 'react'\nimport i18n from '../locales'\nimport {\n    Modal,\n    ModalTitle,\n    ModalContent,\n    ModalActions,\n    Button,\n    InputField,\n} from '@dhis2/ui-core'\n\nconst staticUrl = process.env.REACT_APP_DHIS2_BASE_URL\n\nexport const LoginModal = () => {\n    const [server, setServer] = useState(\n        staticUrl || window.localStorage.DHIS2_BASE_URL || ''\n    )\n    const [username, setUsername] = useState('')\n    const [password, setPassword] = useState('')\n    const [isDirty, setIsDirty] = useState(false)\n\n    const isValid = val => val && val.length >= 2\n\n    const onSubmit = async e => {\n        e.preventDefault()\n        setIsDirty(true)\n        if (isValid(server) && isValid(username) && isValid(password)) {\n            window.localStorage.DHIS2_BASE_URL = server\n            try {\n                await fetch(\n                    `${server}/dhis-web-commons-security/login.action`,\n                    {\n                        method: 'POST',\n                        credentials: 'include',\n                        body: `j_username=${username}&j_password=${password}`,\n                        headers: {\n                            'X-Requested-With': 'XMLHttpRequest',\n                            Accept: 'application/json',\n                            'Content-Type': 'application/x-www-form-urlencoded',\n                        },\n                    }\n                )\n            } catch (e) {\n                console.log(\n                    'TODO: This will always error and cancel the request until we get a real login endpoint!'\n                )\n            }\n\n            // TODO: Hacky solution... this shouldn't require a reload\n            window.location.reload()\n        }\n    }\n\n    return (\n        <Modal open small>\n            <form onSubmit={onSubmit}>\n                <ModalTitle>{i18n.t('Please sign in')}</ModalTitle>\n                <ModalContent>\n                    {!staticUrl && (\n                        <InputField\n                            error={isDirty && !isValid(server)}\n                            label={i18n.t('Server')}\n                            name=\"server\"\n                            type=\"text\"\n                            value={server}\n                            onChange={input => setServer(input.value)}\n                        />\n                    )}\n                    <InputField\n                        error={isDirty && !isValid(username)}\n                        label={i18n.t('Username')}\n                        name=\"j_username\"\n                        type=\"text\"\n                        value={username}\n                        onChange={input => setUsername(input.value)}\n                    />\n                    <InputField\n                        error={isDirty && !isValid(password)}\n                        label={i18n.t('Password')}\n                        name=\"j_password\"\n                        type=\"password\"\n                        value={password}\n                        onChange={input => setPassword(input.value)}\n                    />\n                </ModalContent>\n                <ModalActions>\n                    <Button primary type=\"submit\">\n                        {i18n.t('Sign in')}\n                    </Button>\n                </ModalActions>\n            </form>\n        </Modal>\n    )\n}\n","import { useEffect } from 'react'\nimport i18n from '@dhis2/d2-i18n'\nimport moment from 'moment'\n\ni18n.setDefaultNamespace('default')\n\nconst simplifyLocale = locale => {\n    const idx = locale.indexOf('-')\n    if (idx === -1) {\n        return locale\n    }\n    return locale.substr(0, idx)\n}\n\nconst setGlobalLocale = locale => {\n    if (locale !== 'en' && locale !== 'en-us') {\n        import(`moment/locale/${locale}`).catch(() => {\n            /* ignore */\n        })\n    }\n    moment.locale(locale)\n\n    const simplifiedLocale = simplifyLocale(locale)\n    i18n.changeLanguage(simplifiedLocale)\n}\n\nexport const useLocale = locale => {\n    useEffect(() => {\n        setGlobalLocale(locale || window.navigator.language)\n    }, [locale])\n}\n","import React from 'react'\nimport { useDataQuery } from '@dhis2/app-runtime'\n\nimport { ScreenCover, CircularLoader } from '@dhis2/ui-core'\nimport { LoginModal } from './LoginModal'\nimport { useLocale } from './useLocale'\n\nconst settingsQuery = {\n    userSettings: {\n        resource: 'userSettings',\n    },\n}\n\nexport const AuthBoundary = ({ url, children }) => {\n    const { loading, error, data } = useDataQuery(settingsQuery)\n    useLocale(data && data.userSettings.keyUiLocale)\n\n    if (loading) {\n        return (\n            <ScreenCover>\n                <CircularLoader />\n            </ScreenCover>\n        )\n    }\n\n    if (error) {\n        return <LoginModal url={url} />\n    }\n\n    return children\n}\n","import css from 'styled-jsx/css'\n\nexport const styles = css`\n    div.app-shell-adapter {\n        width: 100vw;\n        height: 100vh;\n\n        display: flex;\n        flex-direction: column;\n    }\n    div.app-shell-app {\n        flex: 1 1 auto;\n        overflow: auto;\n        height: 100%;\n    }\n`\n","import React from 'react'\nimport { HeaderBar } from '@dhis2/ui-widgets'\nimport { Provider } from '@dhis2/app-runtime'\nimport { FatalErrorBoundary } from './FatalErrorBoundary'\nimport { AuthBoundary } from './AuthBoundary'\n\nimport { styles } from './styles.js'\n\n// eslint-disable-next-line react/prop-types\nconst App = ({ url, apiVersion, appName, children }) => (\n    <FatalErrorBoundary>\n        <Provider config={{ baseUrl: url, apiVersion: apiVersion }}>\n            <div className=\"app-shell-adapter\">\n                <style jsx>{styles}</style>\n                <HeaderBar appName={appName} />\n                <AuthBoundary url={url}>\n                    <div className=\"app-shell-app\">{children}</div>\n                </AuthBoundary>\n            </div>\n        </Provider>\n    </FatalErrorBoundary>\n)\n\nexport default App\n"],"names":["bgColor","iconColor","primaryTextColor","secondaryTextColor","errorColor","translatedErrorHeading","i18n","t","replaceNewlinesWithBreaks","text","split","reduce","out","line","i","React","FatalErrorBoundary","props","setState","drawerOpen","state","error","errorInfo","children","window","location","reload","toggleTechInfoDrawer","stack","componentStack","Component","propTypes","PropTypes","node","isRequired","namespace","addResources","enTranslations","esTranslations","frTranslations","staticUrl","process","env","REACT_APP_DHIS2_BASE_URL","LoginModal","useState","localStorage","DHIS2_BASE_URL","server","setServer","username","setUsername","password","setPassword","isDirty","setIsDirty","isValid","val","length","onSubmit","e","preventDefault","fetch","method","credentials","body","headers","Accept","console","log","Modal","ModalTitle","ModalContent","InputField","input","value","ModalActions","Button","setDefaultNamespace","simplifyLocale","locale","idx","indexOf","substr","setGlobalLocale","catch","moment","simplifiedLocale","changeLanguage","useLocale","useEffect","navigator","language","settingsQuery","userSettings","resource","AuthBoundary","url","useDataQuery","loading","data","keyUiLocale","ScreenCover","CircularLoader","styles","App","apiVersion","appName","Provider","baseUrl","HeaderBar"],"mappings":"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"}